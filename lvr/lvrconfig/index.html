



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://umd-lhcb.github.io/ut-hw-doc/lvr/lvrconfig/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.2">
    
    
      
        <title>LVR Configuration - UMD UT hardware documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#abstract" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://umd-lhcb.github.io/ut-hw-doc" title="UMD UT hardware documentation" aria-label="UMD UT hardware documentation" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../images/umd_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              UMD UT hardware documentation
            </span>
            <span class="md-header-nav__topic">
              
                LVR Configuration
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/umd-lhcb/ut-hw-doc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    umd-lhcb/ut-hw-doc
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../dcb/dcb_assembly/dcb_assembly/" class="md-tabs__link">
          DCB
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" class="md-tabs__link md-tabs__link--active">
          LVR
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../minidaq/minidaq_usage/" class="md-tabs__link">
          MiniDAQ
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://umd-lhcb.github.io/ut-hw-doc" title="UMD UT hardware documentation" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../images/umd_logo.png" width="48" height="48">
      
    </a>
    UMD UT hardware documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/umd-lhcb/ut-hw-doc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    umd-lhcb/ut-hw-doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Home
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      DCB
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        DCB
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dcb/dcb_assembly/dcb_assembly/" title="DCB mechanical assembly" class="md-nav__link">
      DCB mechanical assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dcb/dcb_qa/dcb_qa/" title="DCB QA" class="md-nav__link">
      DCB QA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      LVR
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        LVR
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="LVR Configuration" class="md-nav__link md-nav__link--active">
      LVR Configuration
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ccm_id/" title="CCM Identification Guide" class="md-nav__link">
      CCM Identification Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lvrqa/" title="LVR QA" class="md-nav__link">
      LVR QA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ccmqa/" title="CCM QA" class="md-nav__link">
      CCM QA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      MiniDAQ
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        MiniDAQ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../minidaq/minidaq_usage/" title="MiniDAQ usage" class="md-nav__link">
      MiniDAQ usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../minidaq/centos_tips/" title="CentOS tips" class="md-nav__link">
      CentOS tips
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/umd-lhcb/ut-hw-doc/edit/master/docs/lvr/lvrconfig.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="abstract">Abstract</h1>
<p>The following serves as a guide for general LVR operation as well as LVR
QA procedures. The firmware loaded onto the LVRs by default does not
allow for channels to be directly controlled. When power is connected
the channels will come up in sequenced pairs (1-2, then 3-4, etc). It is
therefore important that you only bring up Vin if you are okay with
there being Vout. It is wise to first power up with the loads
disconnected and verify the polarity and amplitude of the outputs.
Beware doing this that if loads are disconnected from Vout but the sense
lines remain hooked up the output will just jump to 5V.</p>
<p>Channels should not be left at 5V output for a long time. There is a
resistor providing 220 Ohm minimal load, which is rated for 0.125W, but
would have to dissipate 0.11W. Therefore, channels with power but no CCM
should be set up as per "other unused channels" below, such that the
power through this resistor is negligible.</p>
<h1 id="channel-sense-lines">Channel Sense lines</h1>
<p>If RJ45 connections to the remote sense are unavailable (broken) the
regulators will fall back on a local sense mode and regulate the output
voltage at their connector instead. The sense line inputs follow RJ45
conventions:</p>
<ul>
<li>
<p>CH1 &amp; CH5 use pins 1&amp;2,</p>
</li>
<li>
<p>CH2 &amp; CH6 use pins 4&amp;5,</p>
</li>
<li>
<p>CH3 &amp; CH7 use pins 3&amp;6,</p>
</li>
<li>
<p>CH4 &amp; CH8 use pins 7&amp;8</p>
</li>
</ul>
<h1 id="setting-up-monitorprogrammer">Setting Up Monitor/Programmer</h1>
<p>This section deal with setting up the monitor/programmer for the LVR.</p>
<p>To set up the programmer:</p>
<p>a.  Turn power off</p>
<p>b.  Connect jumpers between J22 pins 2 &amp; 4 (V_pump)</p>
<p>c.  Connect jumpers between J22 pins 1 &amp; 3 (V_jtag)</p>
<p>d.  Connect programmer to J17.</p>
<p>e.  Turn power on</p>
<p>f.  Initiate the program sequence</p>
<p>g.  Move jumpers on J22 to connect pins 4&amp;6 and pins 3&amp;5</p>
<p>To set up the monitor:</p>
<p>a.  Connect Raspberry PI leads to J18. Note that leads must start at pin
    row 3-4, not 1-2</p>
<p>b.  Turn on raspberry PI and run code</p>
<p>c.  V_SENSE refers to the output feedback voltage from the CCM</p>
<p>d.  V_REGUL_OUT refers to full input voltage</p>
<p>e.  i_SENSE_MON refers to current through resistor ____</p>
<h1 id="fusechannel-configuration">Fuse/Channel Configuration</h1>
<p>This section deals with which channels are being used. Ideally fuses
should be installed only for the channels to be used. Unfused is the
safest state for an unused channel.</p>
<p>The input BBs are mislabeled:</p>
<ul>
<li>
<p>The fuse labeled F3-4 serves ch5+ch6, </p>
</li>
<li>
<p>the fuse labeled F1-2 serves ch7+ch8, </p>
</li>
<li>
<p>the fuse labeled F7-8 serves ch1+ch2,</p>
</li>
<li>
<p>the fuse labelled F5-6 serves ch3+ch4</p>
</li>
</ul>
<p>Input voltage should be set above the UVL (Undervoltage lockout) setting
for that fuse group. As presently configured (pre-slice test) 5.5V
appears adequate for all configurations, but this is subject to further
study</p>
<p>Undervoltage lockout is configured via SW6A-SW6D (that is, one per fuse
group). This circuit disables the associated channels if the input
voltage falls below a threshold set by the switch. Within one SW4x, the
four toggles form a 3-digit number LSB->MSB, with the fourth toggle
putting the channel in an 'always on' state (override UVL).</p>
<p>It is best to be at least 0.25V, preferably 0.5V above the actual
drop-out voltage, otherwise a channel may appear to be on, but when it
actually tries to start the natural drop in Vin from the abrupt increase
in current demand by the regulator causes the UVL to trip, leading to a
series of false-start hiccups rather than actual starts.</p>
<h2 id="configuration-of-lvr">Configuration of LVR</h2>
<p>LVR Configuration is done via the CCMs and the potentiometers P3 and P4,
which should be set according to the CCMs to be installed as</p>
<blockquote>
<p>Vos Vout</p>
</blockquote>
<ul>
<li>
<p>1.775V 2.5V case</p>
</li>
<li>
<p>1.546V 1.5V case</p>
</li>
<li>
<p>1.483V 1.225V case</p>
</li>
</ul>
<p>P3 controls CH1-CH4, P4 controls CH5-CH8, and each group of four must
use the same CCM Vout. Vos may be measured across TP9-TP10 for CH1-4,
and TP14-15 for CH5-8</p>
<h2 id="normal-versus-duty-cycle-mode">Normal versus Duty Cycle Mode</h2>
<p>For Low Duty Cycle Pulsed mode, we enable this via setting SW3-1 to OFF.
It provides a pulse every \~3 seconds that appears to last for \~60ms.
Normal mode (or continuous mode) provides continuous transmission of
voltage.</p>
<p>It is recommended that for operation periods greater than \~20 minutes
to have the board on Duty Cycle Pulsed mode (30-45 min in extreme
cases), whereas short operation periods can utilize continuous mode.
This is to prevent overheating of 4913ADLHC regulator chips on LVR.</p>
<h2 id="masterslave-pairings">Master/slave pairings</h2>
<p>Master slave pairs should ideally always be within a fuse group, and
must follow ascending channel number. That is, CH1 is M and CH2 is S, or
CH3 is M and CH4 is S, or CH5 is M and CH6 is S etc.</p>
<p>In addition to the appropriate CCM type, the firmware must be 'notified'
which channels are M+S pairs, via SW4. The "off" setting of the switch
corresponds to a M+S pair, while the "ON" state is the setting for two
single masters</p>
<ul>
<li>
<p>SW4-1 corresponds to 1-2,</p>
</li>
<li>
<p>SW4-2 to 3-4,</p>
</li>
<li>
<p>SW4-3 to 5-6,</p>
</li>
<li>
<p>SW4-4 to 7-8</p>
</li>
</ul>
<p>Note that when setting up master/slave CCM pairs, slave CCMs should
always be on even numbered CCMs.</p>
<p><img alt="" src="../lvrconfig1.png" /></p>
<p><img alt="" src="../lvrconfig2.png" /></p>
<p>Note: In the current firmware, SW5 contains enables for CH1-4, CH5-8 and a
global standby. To operate the regulator SW5 must be set as: (OFF, OFF,
ON, OFF)</p>
<p><img alt="" src="../lvrconfig3.png" />
Tom\'s notes on the configuration switches for the LVR, including
master/slave and general enables. <strong>**IMPORTANT** THE CONVENTION
HERE IS OPPOSITE WHAT YOU EXPECT BECAUSE THESE ARE SHORTING PULL-UPS.
\"ON\" ON THE SWITCH IS LOGIC 0 AND \"OFF\" IS LOGIC 1.</strong> Also please
note that the physical order is 3,2,4,5, and NOT 2,3,4,5</p>
<p>Note that LVR Configuration is done via the CCMs and the potentiometers
P3 and P4, which should be set according to the CCMs to be installed as</p>
<blockquote>
<p>Vos Vout</p>
</blockquote>
<ul>
<li>
<p>1.775V 2.5V case</p>
</li>
<li>
<p>1.546V 1.5V case</p>
</li>
<li>
<p>1.483V 1.225V case</p>
</li>
</ul>
<p>P3 controls CH1-CH4, P4 controls CH5-CH8, and each group of four must
use the same CCM Vout. Vos may be measured across TP9-TP10 for CH1-4,
and TP14-15 for CH5-8.</p>
<h2 id="overtemperatureundervoltage-lockout">Overtemperature/Undervoltage Lockout</h2>
<p>The overtemperature lockout is configured by SW1. SW1 represents a
binary number with switch 1 the LSB and switch 4 the MSB. Settings which
have been explored in the lab are (in big endian, LSB->MSB)</p>
<ul>
<li>
<p>0101 -- regulator shuts off at 39C</p>
</li>
<li>
<p>1101 -- regulator shuts off at 30C</p>
</li>
<li>
<p>1001 -- regulator shuts off at 55C</p>
</li>
<li>
<p>0001 -- regulator shuts off at 70C</p>
</li>
</ul>
<p>The slice test could easily run at either of the last two.</p>
<p>The undervoltage lockout is configured by SW6(A, B, C, D). We note the
following configurations for each SW6#. Note that if 4 in SW6#[1, 2,
3, 4] is ON, this acts as a bypass for all other switches. We therefore
only consider switcher 1-3:</p>
<p>[0,0,0] - 5.9 V</p>
<p>[1,0,0] - 5.4 V</p>
<p>[0,1,0] - 5.1 V</p>
<p>[0,0,1] - 4.6 V</p>
<p>[1,1,0] - 5.1 V</p>
<p>[0,1,1] - 4.1 V</p>
<p>[1,1,1] - 3.9 V</p>
<p>[1,0,1] - 4.6 V</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../dcb/dcb_qa/dcb_qa/" title="DCB QA" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                DCB QA
              </span>
            </div>
          </a>
        
        
          <a href="../ccm_id/" title="CCM Identification Guide" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                CCM Identification Guide
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>