<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://umd-lhcb.github.io/ut-hw-doc/dcb/dcb_qa/dcb_qa/ rel=canonical><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.5.3"><title>DCB QA - UMD UT hardware documentation</title><link rel=stylesheet href=../../../assets/stylesheets/main.947af8d5.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.7f672a1f.min.css><meta name=theme-color content=#ef5350><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#initial-qa class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://umd-lhcb.github.io/ut-hw-doc title="UMD UT hardware documentation" class="md-header-nav__button md-logo" aria-label="UMD UT hardware documentation"> <img src=../../../umd_logo.png alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> UMD UT hardware documentation </span> <span class="md-header-nav__topic md-ellipsis"> DCB QA </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/umd-lhcb/ut-hw-doc/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> umd-lhcb/ut-hw-doc </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://umd-lhcb.github.io/ut-hw-doc title="UMD UT hardware documentation" class="md-nav__button md-logo" aria-label="UMD UT hardware documentation"> <img src=../../../umd_logo.png alt=logo> </a> UMD UT hardware documentation </label> <div class=md-nav__source> <a href=https://github.com/umd-lhcb/ut-hw-doc/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> umd-lhcb/ut-hw-doc </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Home data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title="Getting started" class=md-nav__link> Getting started </a> </li> <li class=md-nav__item> <a href=../../../license/ title=License class=md-nav__link> License </a> </li> <li class=md-nav__item> <a href=../../../burnin/box_algorithm/ title=boxes class=md-nav__link> boxes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> DCB <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=DCB data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> DCB </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dcb_assembly/dcb_assembly/ title="DCB mechanical assembly" class=md-nav__link> DCB mechanical assembly </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> DCB QA <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="DCB QA" class="md-nav__link md-nav__link--active"> DCB QA </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#initial-qa class=md-nav__link> Initial QA </a> <nav class=md-nav aria-label="Initial QA"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fusing-gbtx class=md-nav__link> Fusing GBTx </a> </li> <li class=md-nav__item> <a href=#setting-up-dcb class=md-nav__link> Setting up DCB </a> </li> <li class=md-nav__item> <a href=#checking-power class=md-nav__link> Checking Power </a> </li> <li class=md-nav__item> <a href=#programming-data-gbtxs class=md-nav__link> Programming Data GBTxs </a> </li> <li class=md-nav__item> <a href=#prbs-test class=md-nav__link> PRBS Test </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-qa class=md-nav__link> Final QA </a> <nav class=md-nav aria-label="Final QA"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#salt-and-tfc-testing class=md-nav__link> SALT and TFC Testing </a> </li> <li class=md-nav__item> <a href=#adc-read-out class=md-nav__link> ADC Read Out </a> </li> <li class=md-nav__item> <a href=#optical-to-master-gbt class=md-nav__link> Optical to Master GBT </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dcb_shipping/dcb_shipping/ title="DCB Shipping" class=md-nav__link> DCB Shipping </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> LVR <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=LVR data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> LVR </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../lvr/lvr_assembly/lvr_assembly/ title="LVR mechanical assembly" class=md-nav__link> LVR mechanical assembly </a> </li> <li class=md-nav__item> <a href=../../../lvr/lvr_qa/lvr_qa/ title="LVR Setup/Initial QA" class=md-nav__link> LVR Setup/Initial QA </a> </li> <li class=md-nav__item> <a href=../../../lvr/qa_final/qa_final/ title="LVR Final QA" class=md-nav__link> LVR Final QA </a> </li> <li class=md-nav__item> <a href=../../../lvr/lvr_config/lvr_config/ title="LVR Configuration" class=md-nav__link> LVR Configuration </a> </li> <li class=md-nav__item> <a href=../../../lvr/ccm_id/ccm_id/ title="CCM Identification Guide" class=md-nav__link> CCM Identification Guide </a> </li> <li class=md-nav__item> <a href=../../../lvr/ccm_test_stand_config/ccm_test_stand_config/ title="CCM Test Stand Configuration" class=md-nav__link> CCM Test Stand Configuration </a> </li> <li class=md-nav__item> <a href=../../../lvr/ccm_qa/ccm_qa/ title="CCM QA" class=md-nav__link> CCM QA </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> MiniDAQ <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=MiniDAQ data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> MiniDAQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../minidaq/minidaq_usage/ title="MiniDAQ usage" class=md-nav__link> MiniDAQ usage </a> </li> <li class=md-nav__item> <a href=../../../minidaq/centos_tips/ title="CentOS tips" class=md-nav__link> CentOS tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Burn-in <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Burn-in data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Burn-in </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../burnin/burnin_hw_setup/burnin_hw_setup/ title="Burn-in hardware setup" class=md-nav__link> Burn-in hardware setup </a> </li> <li class=md-nav__item> <a href=../../../burnin/burnin_sw_setup/ title="Burn-in software setup" class=md-nav__link> Burn-in software setup </a> </li> <li class=md-nav__item> <a href=../../../burnin/lvr_operations/lvr_operations/ title="LVR burn-in operations" class=md-nav__link> LVR burn-in operations </a> </li> <li class=md-nav__item> <a href=../../../burnin/dcb_operations/ title="DCB burn-in operations" class=md-nav__link> DCB burn-in operations </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#initial-qa class=md-nav__link> Initial QA </a> <nav class=md-nav aria-label="Initial QA"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fusing-gbtx class=md-nav__link> Fusing GBTx </a> </li> <li class=md-nav__item> <a href=#setting-up-dcb class=md-nav__link> Setting up DCB </a> </li> <li class=md-nav__item> <a href=#checking-power class=md-nav__link> Checking Power </a> </li> <li class=md-nav__item> <a href=#programming-data-gbtxs class=md-nav__link> Programming Data GBTxs </a> </li> <li class=md-nav__item> <a href=#prbs-test class=md-nav__link> PRBS Test </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-qa class=md-nav__link> Final QA </a> <nav class=md-nav aria-label="Final QA"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#salt-and-tfc-testing class=md-nav__link> SALT and TFC Testing </a> </li> <li class=md-nav__item> <a href=#adc-read-out class=md-nav__link> ADC Read Out </a> </li> <li class=md-nav__item> <a href=#optical-to-master-gbt class=md-nav__link> Optical to Master GBT </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/umd-lhcb/ut-hw-doc/edit/master/docs/dcb/dcb_qa/dcb_qa.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>DCB QA</h1> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Make sure you are grounded at all times when handling the DCB! Failing to do so could destroy the boards!</p> </div> <p>The DCB has a few purposes; aggregating data, controlling the stave, and monitoring. It has 4 optical mezzanines with 3 VTTxs and 1 VTRx, as well as 1 master GBTx, 1 GBT-SCA, and 6 data GBTxs. The DCB talks to the stave through the Backplane connecter and a computer through the mezzanines.</p> <p><img alt="DCB Diagram" src=../overview/dcb_diagram2.png></p> <p>The PRBS test checks the DCB ability to get data from the GBTxs to the computer. A psuedo-random bit sequence, or PRBS, is generated in the data GBTxs and sent to our computer via the VTTxs. This test verifies the black data lines on the image.</p> <p>In the SALT test, we tell the stave what data to send to the DCB to check the grey data lines. Each line represents 12 E-links connecting the stave to the GBTxs. For our tests, we have the stave sending <code>c4</code> repeated to the DCB. It is easy for this to get out of phase, which is why we accept any stable data in the memory monitor as a success. To see possible out-of-phase responses, you can break <code>c4</code> into 8bit binary and shift the bits left or right. You should find <code>26</code>, <code>13</code>, and <code>89</code> are all acceptable.</p> <p><img alt="TFC Diagram" src=../overview/tfc_loopback.png></p> <p>We check the DCB control of the stave by testing TFC loopback, where a GBTx sends a header of <code>04</code> to the stave. We know the E-links will be good as they have just been checked, so we expect to see the stave repeating 04 back to us if everything is working correctly. It is also fine here to see a bit-shift, making it look like the stave is repeating <code>01</code>, <code>02</code>, or <code>08</code>.</p> <p>There are also ADCs (analog to digital converters) we look at to verify the power and, for the ones attached to thermistors, monitor the temperature on the DCB itself and the stave.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Make sure to keep the <a href=https://docs.google.com/spreadsheets/d/1KjXGhOFzi0SZPsozpKzxGjVtfr4kkS_Hv5EigUwKOj8/edit title=Database>database</a> up to date as you go through the tests.</p> </div> <h2 id=initial-qa>Initial QA</h2> <h3 id=fusing-gbtx>Fusing GBTx</h3> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>If the DCB has already gone through the burn-in, skip fusing and go straight to "<a href=./#setting-up-dcb>Setting up DCB</a>"</p> </div> <p>Verify the jumper on <strong><code>J2</code></strong>, next to the optical mezzanines, looks like this <img alt="Fuse Jumper" src=../fusing/fuse_jumper.jpg></p> <p>There will already be an optical mezzanine connected to a dongle that you need to attach to the DCB, verify that the dongle coneections look like this. <img alt="Dongle Connection 2" src=../fusing/fuse_dongle.jpg> The mezzanine goes over the outline with the label <code>OMDBMC</code>. Don't worry about screwing it in, this is a temporary setup.</p> <p><img alt="Dongle Connection" src=../fusing/fuse_connection_LI.jpg></p> <p>On the left of the picture is a different power breakout board that must also be attached. Its powered by two 1.5 volt connections with amp limit 2.5 and one 3.3 volt connection with amp limit 0.5, the power setup should look like the picture below. Power on the DCB.</p> <p><img alt="Fusing Power" src=../fusing/fuse_power_setup.jpg></p> <ol> <li> <p>Open the <strong>GBTX Programmer</strong> on the windows PC. If it's not already open you can find it under <code>D:/Users/DT_Rack/GBTx_Programmer</code> as a jar file called <code>programmerv2.20180725.jar</code>.</p> </li> <li> <p>Check the connection is working by clicking <strong>Read GBTX</strong>, the state should change to <code>pauseForConfig</code></p> </li> <li> <p>Go to the <strong>Fuse my GBTx</strong> tab all the way on the right</p> <ul> <li>click <strong>Import Image</strong>, make sure you can see .txt files, and select <code>master.txt</code></li> <li>click <strong>Write GBTX</strong> then <strong>Read GBTX</strong>, the state should change to <code>waitDESLock</code>. If the state changes to anything with a hex value larger than 0x0A (state hex value is listed right after the name, 0x0A is <code>waitDESlock</code>), eg. 0x0B or 0x11, please follow the instructions outlined <a href=https://github.com/umd-lhcb/lab-notes/issues/70>here</a>, and make a note in the database.</li> <li>to the right of table, find and click update view. All of the entries in the table should now be green</li> <li> <p>Now check <strong>enable fusing</strong> and <strong>fuse updateConfig</strong>, and click the big <strong>FUSE</strong> button at the bottom</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Register 365 should not be checked and fused.</p> </div> </li> </ul> </li> <li> <p>Shut off power to the DCB and move the right jumper on <strong><code>J2</code></strong> up one to be in-line with the other jumper.</p> <p><img alt="DCB Jumper After Fuse" src=../fusing/jumper_after_fuse_li.jpg></p> </li> <li> <p>To verify the fuse was successful, power the DCB back on.</p> <ul> <li>in the <strong>GBTX Programmer</strong>, read and update view like before. The table should still be all green, except the last register 365.</li> </ul> </li> <li> <p>Shut off the power again, and add a red jumper to connector <strong><code>J4</code></strong> as shown <img alt="Jumper J4" src=../fusing/jumper_crop.jpg></p> </li> <li> <p>Take off the mezzanine with the dongle and attach all 4 of the mezzanines that came with the DCB. Make sure the red VTRx mezzanine goes on the connector <code>OMDBMC</code></p> </li> </ol> <h3 id=setting-up-dcb>Setting up DCB</h3> <ol> <li> <p>Verify the backplane connector EVERY time before pluuging it into the backplane. Do not plug in if its pins are bent, as it can break the backplane. Check for pieces of thermal gap in the connector and clean it before plugging it it.</p> </li> <li> <p>Verify optical mezzanines are attached. They should rest on the long hex nuts.</p> </li> <li> <p>Attach optical fibers to the mezzanines. Two fibers go into each board. They should be sequential except for the two attached fibers which go to the master.</p> <ul> <li>The order should be something like 1, 2, Masters, 3, 4, 5, 6</li> <li>The Master is connected to fiber 3 which corresponds to GBT ID 10</li> <li>The optical fibers for the Master should be marked with black marker. The one with the thin white ribbon (circled in red below) should go on the left when facing the DCB (mezzanines toward you) <img alt="DCB Optical Fibers Labeled" src=../setup_backplane/optical_fibers_masters_labeled_2.jpg></li> </ul> </li> <li> <p>Correct slot based on stave connection</p> <ul> <li>will either be <strong><code>JD10</code></strong> (for stave <strong><code>JP8</code></strong>) or <strong><code>JD11</code></strong> (for stave <strong><code>JP11</code></strong>)</li> </ul> </li> <li> <p>Slide DCB into the proper slot using the heat spreader pipes as handles. Let it gently go down until until the guide rails at the bottom go in and the DCB sits correctly. Then push until it clicks in.</p> </li> </ol> <h3 id=checking-power>Checking Power</h3> <p>There are 3 separate power lines, for the DCB, the VTTx's, and the Stave. They should not be moved or changed over the course of this QA, but it is good to verify the connections are correct.</p> <ul> <li> <p>DCB</p> <ol> <li>Power comes to pairs of boards as labeled by the slot they are put in. 0 and 1, 2 and 3, etc...</li> <li>A set of 8 cables are split into groups of 4 labeled <code>DCB-A</code> and <code>DCB-B</code>. The sets are broken down into two more sets of two; a master and slave (labeled M and S) which each have a source and return.<ul> <li>A goes to the even board of a pair, slot <strong><code>JD10</code></strong>, and B goes to the odd board, <strong><code>JD11</code></strong>.</li> <li>It does not matter which wire gets the masters and which gets the slave</li> </ul> </li> <li><code>SRC</code> connects to the wire labeled 1v5 and <code>RET</code> connects to ground for all 4 pairs.</li> </ol> </li> <li> <p>VTTx</p> <ol> <li>There is a set of power and ground cables labeled <code>2v5 VTTX CH 3</code> and <code>RET</code> that we'll connect to a set of wires with a tag "JD10/11"</li> <li>The <code>2v5 VTTX</code> cable connects to the wire labeled 2v5 and <code>RET</code> goes to ground.</li> </ol> </li> <li> <p>Stave</p> <ol> <li>There's P1, P2, P3, and P4 which each have <code>SRC</code> and <code>RET</code>. Make sure <code>P1 SRC</code> goes to <code>P1 SRC</code> and so on for all 8 wires.</li> </ol> </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>On the Linux computer, we'll use nanoDAQ which gives some MiniDAQ functions in Python. Go to <code>$HOME/src/nanoDAQ</code> in a command line on the server to use. Also open MiniDAQ by going to <strong>Applications</strong>, <strong>WinCC</strong>, <strong>Project Administrator</strong>, then double click on the top project.</p> </div> <h3 id=programming-data-gbtxs>Programming Data GBTxs</h3> <p>There are 6 data GBTxs on each DCB, and these must be programed every time the board gets power cycled.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>nanoDAQ</code> has some documentation <a href=https://github.com/umd-lhcb/nanoDAQ/blob/master/README.md>here</a>.</p> <p>A pdf that goes over a lot of MiniDAQ and GBTx usage can be downloaded <a href=https://github.com/umd-lhcb/gbtx_brds_doc/releases/download/0.8.5/gbtx_brds_doc.pdf>here</a>.</p> </div> <ol> <li>Power on the DCB.</li> <li> <p>In the <code>nanoDAQ</code> command prompt, we're going to pull the reset, also called GPIO, low and try to program it then high and try to program it.</p> </li> <li> <p>First, enter <code>./dcbutil.py gpio --reset 0 1 2 3 4 5 6 --final_state low -g 10</code> to pull all resets low. Then attempt to program the GBTxs with <code>./dcbutil.py init ./gbtx_config/slave-Tx-wrong_termination.txt -g 10</code></p> <ul> <li>You should get an error</li> </ul> </li> <li> <p>Now do the reverse by changing --final_state to high to enter <code>./dcbutil.py gpio --reset 0 1 2 3 4 5 6 --final_state high -g 10</code> You should now be able to program the GBTxs with the command you inputted earlier.</p> </li> </ol> <h3 id=prbs-test>PRBS Test</h3> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This is the MiniDAQ "Top" panel that is referenced a couple times. Most menus can be found starting from this panel.</p> <p><img alt="TOP Panel" src=../prbs/top.png></p> </div> <ol> <li> <p>To start PRBS, go to the nanoDAQ command line and enter <code>./dcbutil.py prbs on -g 10</code></p> </li> <li> <p>Open the PRBS panel by going to the top MiniDAQ hardware panel and clicking <strong>PRBS</strong>.</p> <ul> <li>In the top left of the panel, click in order: <br> Stop All Generators → Stop All Checkers → Reset All Counters → <br> Start All Generators → Start All Checkers → Start All Counters</li> </ul> <p><img alt="PRBS Test Panel" src=../prbs/prbs.png></p> </li> <li> <p>Allow test to run for <strong>1-5 minutes</strong>. It passes if there are 6 green channels shown on the PRBS panel.</p> <ul> <li>The picture shows 6 red ones. These are the correct channels and should be green if everything passes</li> </ul> </li> <li> <p>There is a screen above the power switch that shows some readout values for the lvr. In the top left chunk, we care about the values of <code>i_SENSE_MON3</code>, <code>i_SENSE_MON4</code>, and <code>i_SENSE_MON7</code>.</p> <ul> <li>Add the values from 3 and 4 together and record it on the database under "1.5V current[A]"</li> <li>Record the value from 7 on the database under "2.5V current[A]"</li> </ul> <p><img alt=Monitor src=../prbs/monitor_edit.jpg></p> </li> <li> <p>Check if the DCB can regain lock by unplugging the master optical fibers then plugging them back in.</p> <ul> <li>Enter <code>./dcbutil.py prbs off -g 10</code> in the nanoDAQ command line. No output is a success, otherwise it will report "Master GBT not locked"</li> </ul> </li> </ol> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p><strong>Stop here if the DCB has NOT gone through the burn-in yet!!!</strong></p> </div> <h2 id=final-qa>Final QA</h2> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Follow the "<a href=./#setting-up-dcb>Setting up DCB</a>", "<a href=./#checking-power>Checking Power</a>","<a href=./#programming-data-gbtxs>Programming Data GBTxs</a>" and "<a href=./#prbs-test>PRBS Test</a>" instructions above before moving to the SALT and TFC test. In particular, remember to turn PRBS off before beginning. </p> </div> <h3 id=salt-and-tfc-testing>SALT and TFC Testing</h3> <p>The following three tests (SALT, TFC, and ADC) have different instructions dependant on the slot the DCB is connected to, which is determined by the stave connection. Each slot only tests half of the board. Remember <strong><code>JP8</code></strong> goes to slot <strong><code>JD10</code></strong> and <strong><code>JP11</code></strong> goes to slot <strong><code>JD11</code></strong>. Changing the stave connection is a process, so we'll test the same half on many boards, then swap everything to check the other half.</p> <p>For this step, we need to open the <strong>Memory Monitoring</strong> panel in MiniDAQ. In the Top panel, double click <strong>DAQ</strong> to open a new window, then keep double clicking <strong>TELL40</strong> until the following panel shows up, with the tab for <strong>Memory Monitoring</strong> on the right.</p> <p><img alt="Memory Monitoring Panel" src=../extra/mem_mon.png></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The last <strong>TELL40</strong> has a suffix, click on the first <strong>Dev1_0</strong></p> </div> <ol> <li>Power on the SALT.</li> <li> <p>In <code>nanoDAQ</code>, type in the command <code>./dcbutil.py gpio --reset 0 1 2 3 4 5 --final_state low -g 10</code> (note there is no <code>6</code> now)</p> <ul> <li>Now type <code>./saltutil.py [I2C] read 0 0 1 -g 10</code> replacing the <code>[I2C]</code> with <code>3</code>, <code>4</code>, and <code>5</code> if the DCB is in slot <strong><code>JD10</code></strong>.</li> <li>Replace with <code>0</code>, <code>1</code>, <code>2</code> if the DCB is in slot <strong><code>JD11</code></strong></li> <li>You have to enter this command 3 times, once for each number.</li> <li>If it is working correctly you'll get an error</li> </ul> </li> <li> <p>Repeat the process but change the final state to high. You should get a result.</p> <ul> <li><code>./dcbutil.py gpio --reset 0 1 2 3 4 5 --final_state high -g 10</code></li> </ul> </li> <li> <p>SALT testing</p> <ol> <li>Type <code>./saltutil.py [I2C] init -g 10</code> into <code>nanoDAQ</code>, filling in <code>[I2C]</code> with <code>3</code>, <code>4</code>, or <code>5</code> if the DCB is in slot <strong><code>JD10</code></strong> or with <code>0</code>, <code>1</code>, <code>2</code> if the DCB is in slot <strong><code>JD11</code></strong></li> <li>Type <code>./dcbutil.py init ~/bin/tmp_0.xml -g 10 -s [GBT]</code>, with <code>[GBT]</code> the corresponding GBT for your current I2C (see table below).</li> <li>Go to the memory monitoring panel and select the corresponding link for your GBT/I2C<ul> <li>Verify that <strong>Write Address Memory</strong> on the right changes values every couple seconds and <strong>Write Signal Status</strong> is green.</li> </ul> </li> <li>Now look at the table, focusing on the latter 3 columns. There are 8 digits in each column. If they are NOT stable values, go to <code>nanoDAQ</code> and type <code>./dcbutil.py init ~/bin/tmp_1.xml -g 10 -s [GBT]</code><ul> <li>keep incrementing the <code>tmp_*.xml</code> until the values are a stable bit shift of <code>c4</code>.</li> <li>there are 24 digits (8 x 3 columns) we care about, with 6-digit groups for 4 ASICs (6 x 4 groups); the 8-digit columns are not the groupings we care about.</li> <li>it is okay if the groups' digits don't agree, but each single group should have the same, stable digits once finding the right <code>tmp_*.xml</code></li> </ul> </li> </ol> </li> <li> <p>TFC testing</p> <ol> <li>Type <code>./saltutil.py [I2C] ser_src tfc -g 10</code> into <code>nanoDAQ</code>, continuing with the same I2C from the previous step.<ul> <li>The values in the table should be 01, 02, 04, or 08 repeating</li> </ul> </li> <li>Repeat the SALT and TFC testing for the other I2C/GBT/link pairs</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Refer to this table for which GBTs, I2Cs, and links correspond to one another</p> <table> <thead> <tr> <th align=center>Slot</th> <th align=center>GBT</th> <th align=center>I2C</th> <th align=center>Link Selection</th> </tr> </thead> <tbody> <tr> <td align=center><code>JD10</code></td> <td align=center>1</td> <td align=center>4</td> <td align=center>22</td> </tr> <tr> <td align=center><code>JD10</code></td> <td align=center>2</td> <td align=center>3</td> <td align=center>12</td> </tr> <tr> <td align=center><code>JD11</code></td> <td align=center>3</td> <td align=center>2</td> <td align=center>23</td> </tr> <tr> <td align=center><code>JD11</code></td> <td align=center>4</td> <td align=center>1</td> <td align=center>21</td> </tr> <tr> <td align=center><code>JD11</code></td> <td align=center>5</td> <td align=center>0</td> <td align=center>14</td> </tr> <tr> <td align=center><code>JD10</code></td> <td align=center>6</td> <td align=center>5</td> <td align=center>13</td> </tr> </tbody> </table> </div> </li> </ol> <h3 id=adc-read-out>ADC Read Out</h3> <p>If there is no MiniDAQ panel called <strong>GBT Client</strong> already open, open it by going back to the MiniDAQ UI (the one with "Gedi" in its title) and under <strong>LHCB Framework</strong>, click <strong>GBT Client</strong>. Choose GBT under Communication on the top left. Now navigate to the <strong>ADC</strong> tab.</p> <p><img alt="Therm Readout Panel" src=../adc/gbt_client_adc_readout_readchannel.png></p> <ol> <li>Configure settings and check ADC read outs as follows<ul> <li><strong>PC</strong>: UMDlab, <strong>GBT ID</strong>: 10, <strong>SCA ID</strong>: 0, <strong>Version</strong>: 2</li> <li>First click <strong>Activate Channel</strong></li> <li>For now, set address to <strong>Read Channel</strong> and <strong>Line</strong> to 24, then 25, then 0. For each line, clicking read on the right updates the <strong>Data out</strong> field.</li> <li>Power lines: line 24 should be around 0.83 and line 25 should be around 0.5, both within ~0.02</li> <li>Line 0 should be around 0.53, within ~0.04 (depending on the temperature)</li> </ul> </li> <li> <p>When looking in slot <strong><code>JD10</code></strong></p> <ul> <li>Also read out lines 5, 6, and 7. They should all be 0.55, within ~0.04</li> </ul> </li> <li> <p>When looking in slot <strong><code>JD11</code></strong></p> <ul> <li>Also read out lines 2, 3, and 4. They should all be 0.55, within ~0.04</li> </ul> </li> <li> <p>Change address to <strong>Current Source</strong> and put <code>ffffffff</code> (8 <code>f</code>s) in <strong>Data in</strong>, then click <strong>write/read</strong></p> </li> <li> <p>Put address back to <strong>Read Channel</strong> and check lines 1, 16, 17, and 18 by clicking read and looking at <strong>Data out</strong></p> <ul> <li>Expected value 0.29 (was 0.15 for prototype DCBs before), within ~0.04 (temperature specified <a href=https://github.com/umd-lhcb/lab-notes/issues/10>here</a>, 0.32 corresponds to 50 degree celsius, higher value corresponds to smaller T)</li> </ul> </li> </ol> <h3 id=optical-to-master-gbt>Optical to Master GBT</h3> <p>We want to verify that we can communicate to the Master GBTx through the optical fibers. Make sure <strong>GBT Client</strong> is still open, and go to the tab labeled <strong>GBT</strong>.</p> <ol> <li> <p>Set up <strong>GBT Client</strong> such that <strong>GBT ID</strong>: 10, <strong>Device Address</strong>: 7, <strong>Register Address</strong>: 28, Size: 1</p> <ul> <li>Click Read on the right and you should see <code>00</code> in <strong>Data out</strong></li> </ul> </li> <li> <p>Put <code>ff</code> in <strong>Data in</strong> and click <strong>write/read</strong></p> <ul> <li><strong>Data out</strong> should now read <code>ff</code></li> </ul> </li> </ol> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../../dcb_assembly/dcb_assembly/ title="DCB mechanical assembly" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> DCB mechanical assembly </div> </div> </a> <a href=../../dcb_shipping/dcb_shipping/ title="DCB Shipping" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> DCB Shipping </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.c3dc8c49.min.js></script> <script src=../../../assets/javascripts/bundle.f9edbbd5.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8e2cddea.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>